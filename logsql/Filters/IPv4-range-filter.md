### Фильтр диапазонов IPv4

Если требуется отфильтровать сообщения журнала по полю, содержащему **только** IPv4‑адреса (например, `1.2.3.4`), можно использовать фильтр `ipv4_range()`.

Например, следующий запрос отбирает записи журнала, где адрес в поле `user.ip` попадает в диапазон `[127.0.0.0 – 127.255.255.255]`:

```logsql
user.ip:ipv4_range(127.0.0.0, 127.255.255.255)
```

Функция `ipv4_range()` также поддерживает IPv4‑подсети в нотации **CIDR** (Classless Inter‑Domain Routing).

Например, следующий запрос эквивалентен предыдущему:

```logsql
user.ip:ipv4_range("127.0.0.0/8")
```

Если нужно сопоставить **единственный** IPv4‑адрес, просто передайте его в `ipv4_range()`. Например, этот запрос отбирает IP‑адрес `1.2.3.4` в поле `user.ip`:

```logsql
user.ip:ipv4_range("1.2.3.4")
```

**Важно:** `ipv4_range()` **не сопоставляет** строку с IPv4‑адресом, если в ней есть другой текст.

Например, `ipv4_range("127.0.0.0/24")` **не найдёт** запись журнала `request from 127.0.0.1: done`, поскольку IP‑адрес `127.0.0.1` окружён другим текстом.

Чтобы решить эту задачу:
1. Извлеките IP‑адрес из сообщения с помощью конвейера [`extract`](https://docs.victoriametrics.com/victorialogs/logsql/#extract-pipe).
2. Примените фильтр `ipv4_range()` к извлечённому полю.

### Полезные советы

- Если нужно найти **сообщения журнала**, содержащие конкретный IPv4‑адрес `X.Y.Z.Q`, используйте запрос `"X.Y.Z.Q"`. Подробнее — в [документации по фильтрам фраз](https://docs.victoriametrics.com/victorialogs/logsql/#phrase-filter).
- Если требуется найти сообщения, содержащие **хотя бы один** IPv4‑адрес из списка, используйте запрос `"ip1" OR "ip2" ... OR "ipN"`. Подробнее — в [документации по логическим фильтрам](https://docs.victoriametrics.com/victorialogs/logsql/#logical-filter).
- Чтобы найти записи с полем `ip` в **нескольких диапазонах**, используйте запрос:  
  ```
  ip:(ipv4_range(range1) OR ipv4_range(range2) ... OR ipv4_range(rangeN))
  ```
  Подробнее — в [документации по логическим фильтрам](https://docs.victoriametrics.com/victorialogs/logsql/#logical-filter).

### Советы по производительности

- Предпочитайте запросы к **чистому IPv4‑полю** вместо извлечения IPv4 из текстового поля с помощью преобразований ([transformations](https://docs.victoriametrics.com/victorialogs/logsql/#transformations)) во время выполнения запроса.
- Смотрите [другие советы по производительности](https://docs.victoriametrics.com/victorialogs/logsql/#performance-tips).

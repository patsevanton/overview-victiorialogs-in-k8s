### pipe `uniq`

Пайп
`<q> | uniq by (field1, ..., fieldN)`
возвращает уникальные значения для указанных [полей логов](https://docs.victoriametrics.com/victorialogs/keyconcepts/#data-model)
по логам, возвращаемым [запросом](https://docs.victoriametrics.com/victorialogs/logsql/#query-syntax) `<q>`.
Например, следующий запрос LogsQL возвращает уникальные значения поля лога `ip`
за последние 5 минут:

```logsql
_time:5m | uniq by (ip)
```

Внутри выражения `by(...)` можно указать несколько полей. В этом случае будут возвращены все уникальные наборы значений для заданных полей.
Например, следующий запрос возвращает все уникальные пары `(host, path)` по логам за последние 5 минут:

```logsql
_time:5m | uniq by (host, path)
```

Уникальные записи возвращаются в произвольном порядке. При необходимости их можно отсортировать с помощью пайпа [`sort`](https://docs.victoriametrics.com/victorialogs/logsql/#sort-pipe).

Добавьте `with hits` после `uniq by (...)`, чтобы вернуть количество совпадающих логов для каждого значения поля:

```logsql
_time:5m | uniq by (host) with hits
```

Уникальные значения хранятся в памяти во время выполнения запроса. Большое количество уникальных выбранных значений может требовать значительного объёма памяти.
Иногда достаточно вернуть не более `N` уникальных значений. Это можно сделать, добавив `limit N` после выражения `by (...)`. Это позволяет ограничить использование памяти.
Например, следующий запрос возвращает до 100 уникальных пар `(host, path)` по логам за последние 5 минут:

```logsql
_time:5m | uniq by (host, path) limit 100
```

Если лимит `limit` достигнут, может быть возвращено произвольное подмножество уникальных значений. Подсчёт `hits` не работает, если лимит был достигнут.

Ключевое слово `by` в пайпе `uniq ...` можно опустить. Например, следующий запрос эквивалентен предыдущему:

```logsql
_time:5m | uniq (host, path) limit 100
```

### Конвейер `pack_logfmt`

Конструкция  
```
<q> | pack_logfmt as field_name
```  
`конвейер` упаковывает все `поля` каждой записи журнала, возвращённой запросом `<q>` `query`, в сообщение формата `logfmt` и сохраняет его в виде строки в указанном поле `field_name`.

**Пример.** Следующий запрос упаковывает все поля в сообщение формата `logfmt` и сохраняет результат в поле ``_msg`` для журналов за последние 5 минут:

```logsql
_time:5m | pack_logfmt as _msg
```

Часть `as _msg` можно опустить, если упакованное сообщение сохраняется в поле ``_msg``. Следующий запрос эквивалентен предыдущему:

```logsql
_time:5m | pack_logfmt
```

Если нужно упаковать в `logfmt` лишь подмножество полей, их следует перечислить внутри `fields (...)` после `pack_logfmt`.

**Пример.** Нижеприведённый запрос формирует сообщение `logfmt`, включающее только поля `foo` и `bar`, и сохраняет результат в поле `baz`:

```logsql
_time:5m | pack_logfmt fields (foo, bar) as baz
```

В `fields (...)` можно передавать префиксы полей — тогда будут упакованы лишь те поля, которые начинаются с указанных префиксов.

**Пример.** Следующий запрос строит сообщение `logfmt`, включающее все поля, начинающиеся с `foo.` или `bar.`:

```logsql
_time:5m | pack_logfmt fields (foo.*, bar.*) as baz
```

Конвейер `pack_logfmt` не изменяет и не удаляет другие поля. Если они не нужны, добавьте ``| fields ...`` после `pack_logfmt`.

**Пример.** Нижеприведённый запрос оставляет только поле `foo`, при этом исходные поля журнала упакованы в формат `logfmt`:

```logsql
_time:5m | pack_logfmt as foo | fields foo
```

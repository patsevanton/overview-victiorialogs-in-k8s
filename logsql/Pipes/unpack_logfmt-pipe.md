### pipe unpack_logfmt

`<q> | unpack_logfmt from field_name` — это `pipe`, который распаковывает поля формата `k1=v1 ... kN=vN` `logfmt`
из указанного ``field_name`` в результатах `запроса` `<q>` в поля `k1`, …, `kN`
с соответствующими значениями `v1`, …, `vN`.
Существующие поля с именами из списка `k1`, …, `kN` будут перезаписаны. Остальные поля остаются без изменений.

Например, следующий запрос распаковывает поля `logfmt` из
`поля `_msg``
для логов за последние 5 минут:

```logsql
_time:5m | unpack_logfmt from _msg
```

Часть `from _msg` можно опустить, если поля logfmt распаковываются из
`поля `_msg``.
Следующий запрос эквивалентен предыдущему:

```logsql
_time:5m | unpack_logfmt
```

Если нужно распаковать только некоторые поля из logfmt, их можно перечислить в `fields (...)`.
Например, следующий запрос извлекает только поля `foo` и `bar`
из logfmt, хранящегося в поле `my_logfmt`:

```logsql
_time:5m | unpack_logfmt from my_logfmt fields (foo, bar)
```

Если требуется извлечь все поля с общим префиксом, можно использовать синтаксис `fields(prefix*)`.

Если необходимо сохранить исходные непустые значения полей, добавьте `keep_original_fields`
в конец `unpack_logfmt ...`. Например, следующий запрос сохраняет исходные непустые значения
полей `ip` и `host`, вместо того чтобы перезаписывать их распакованными значениями:

```logsql
_time:5m | unpack_logfmt from foo fields (ip, host) keep_original_fields
```

Добавьте `skip_empty_results` в конец `unpack_logfmt ...`, если исходные значения полей
должны сохраняться в случае, когда соответствующие распакованные значения пустые.
Например, следующий запрос сохраняет исходные значения полей `ip` и `host`
при пустых распакованных значениях:

```logsql
_time:5m | unpack_logfmt fields (ip, host) skip_empty_results
```

#### Условный unpack_logfmt

Если `pipe `unpack_logfmt``
нужно применять только к некоторым
`записям логов`,
добавьте `if (<filters>)` после `unpack_logfmt`.

`<filters>` может содержать любые
`фильтры`.
Например, следующий запрос распаковывает поля logfmt из поля `foo`
только если поле `ip` в текущей записи лога не задано или пустое:

```logsql
_time:5m | unpack_logfmt if (ip:"") from foo
```
